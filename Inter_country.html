<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Ticket Track - Inter Country</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
   <!-- Bootstrap CSS v5.3.2 -->
   <link
   href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
   rel="stylesheet"
   integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
   crossorigin="anonymous"
 />
 <link
 href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css"
 rel="stylesheet"
/>
    <link rel="stylesheet" href="CSS/style.css" />
    <link rel="stylesheet" href="CSS/nav_bar.css">
  </head>
  
</head>
<body>
  <div class="container-fluid px-0">
    <div class="row gx-0">
      <div class="col-md-12">
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
          <div class="container-fluid navigation px-0">
            <img src="Images/Ticket Track Card Prototype.png" width="110px" height="90px" />
            <a class="navbar-brand title" href="index.html">Ticket Track</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarNavDropdown">
              <ul class="navbar-nav mx-auto">
                <li class="nav-item">
                  <a class="nav-link" aria-current="page" href="index.html">
                    <i class="bi bi-house-door"></i> Home
                  </a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-ticket-perforated"></i> Book &#9660;
                  </a>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="Inter_country.html"><i class="bi bi-globe"></i> Inter Country</a></li>
                    <li><a class="dropdown-item" href="Intra_country.html"><i class="bi bi-map"></i> Intra Country</a></li>
                  </ul>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="routes.html">
                    <i class="bi bi-map"></i> Routes
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="guides.php">
                    <i class="bi bi-book"></i> Guide
                  </a>
                </li>
              </ul>
              <ul class="navbar-nav ms-auto" id="nav-user">
                <li class="nav-item">
                  <a class="nav-link custom-login-btn" href="login.html">
                    Login
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </div>
   <!-- Navigation bar ends here-->

    <div class="row">
      <div class="col-md-12">
        <div class="container mt-5">
          <div class="card train-booking-card">
            <div class="card-body" style="background-color: #9aaeb7">
              <h2 class="card-title">Train Booking</h2>
              <h3 class="card-title">Country to Country</h3>
              <form id="bookingForm">
                <div class="form-group">
                  <label for="name" class="text">Name of Passenger</label>
                  <input
                    type="name"
                    class="form-control box"
                    id="name"
                    placeholder="Enter the name of passenger"
                  />
                  <div id="nameError" class="error"></div>
                </div>
                <div class="form-group">
                  <label for="departure" class="text">Departure Station</label>
                  <select class="form-control box" id="departure"></select>
                  <div id="departureError" class="error"></div>
                </div>
                <div class="form-group">
                  <label for="arrival" class="text">Arrival Station</label>
                  <select class="form-control box" id="arrival"></select>
                  <div id="arrivalError" class="error"></div>
                </div>
                <div class="form-group">
                  <label for="idcard" class="text">Identity Card Number</label>
                  <input
                    type="text"
                    class="form-control box"
                    id="idcard"
                    maxlength="12"
                    placeholder="Enter your identity card number"
                  />
                  <div id="idCardError" class="error"></div>
                </div>
                <div class="form-group">
                  <label for="date" class="text">Date of Travel</label>
                  <input type="date" class="form-control box" id="date" />
                  <div id="dateError" class="error"></div>
                </div>
                <div class="form-group">
                  <label for="time" class="text">Time</label>
                  <select class="form-control box" id="time">
                    <option value="-1">Choose the time</option>
                    <option value="08:00 A.M">08:00 A.M</option>
                    <option value="12:00 P.M">12:00 P.M</option>
                    <option value="04:00 P.M">04:00 P.M</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="category" class="text">Category of Seat</label>
                  <select class="form-control box" id="category">
                    <option value="-1">Choose the seat category</option>
                    <option value="Window">Window</option>
                    <option value="Aisle">Aisle</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="passengers" class="text">Number of Passengers</label>
                  <input
                    type="number"
                    class="form-control box"
                    id="passengers"
                    min="1"
                    max="5"
                    placeholder="Enter the number of passengers"
                  />
                </div>
                <button
                  type="submit"
                  class="btn btn-light"
                  style="margin-top: 15px; font-weight: bold; font-size: 18px"
                >
                  Book Now
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br /><br />
    <hr />
    <footer class="footer bg-custom text-light py-3">
      <div class="container d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <img
            src="Images\Ticket Track Card Prototype.png"
            alt="Train Track Logo"
            class="footer-logo me-2"
            style="width: 70px; height: 50px"
          />
          <span
            class="fs-4"
            style="
              font-family: brush-script;
              font-size: 30px !important;
              font-weight: bold;
            "
            ><b>Train Track</b></span
          >
        </div>
        <div class="social-icons d-flex">
          <a href="https://www.facebook.com/raileurope/" target="_blank" class="mx-2"
            ><img src="Images\facebook.webp" alt="Facebook" class="social-icon"
          /></a>
          <a href="https://www.instagram.com/raileurope/?hl=en" target="_blank" class="mx-2"
            ><img src="Images\insta.png" alt="Instagram" class="social-icon"
          /></a>
          <a href="https://www.youtube.com/@CoasterFan2105" target="_blank" class="mx-2"
            ><img src="Images\youtube.jpg" alt="YouTube" class="social-icon"
          /></a>
          <a href="https://twitter.com/raileurope" target="_blank" class="mx-2"
            ><img src="Images\twitter.png" alt="Twitter" class="social-icon"
          /></a>
        </div>
      </div>
    </footer>
    <!-- Bootstrap JavaScript Libraries -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"
    ></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
  // Fetch routes and populate the dropdowns
  fetch('get_country_routes.php')
    .then(response => response.json())
    .then(data => {
      if (data.status === "success") {
        const departureSelect = document.getElementById('departure');
        const arrivalSelect = document.getElementById('arrival');

        data.routes.forEach(route => {
          const departureOption = document.createElement('option');
          departureOption.value = route.departure;
          departureOption.textContent = route.departure;
          departureSelect.appendChild(departureOption);

          const arrivalOption = document.createElement('option');
          arrivalOption.value = route.arrival;
          arrivalOption.textContent = route.arrival;
          arrivalSelect.appendChild(arrivalOption);
        });
      } else {
        console.error('Error fetching routes:', data.message);
      }
    })
    .catch(error => console.error('Error fetching routes:', error));

  // Form submission and validation logic
  document.getElementById('bookingForm').addEventListener('submit', function(event) {
    event.preventDefault();
    
    const name = document.getElementById('name').value;
    const departure = document.getElementById('departure').value;
    const arrival = document.getElementById('arrival').value;
    const idcard = document.getElementById('idcard').value;
    const date = document.getElementById('date').value;
    const time = document.getElementById('time').value;
    const category = document.getElementById('category').value;
    const passengers = document.getElementById('passengers').value;

    const nameError = document.getElementById('nameError');
    const departureError = document.getElementById('departureError');
    const arrivalError = document.getElementById('arrivalError');
    const idCardError = document.getElementById('idCardError');
    const dateError = document.getElementById('dateError');

    nameError.textContent = '';
    departureError.textContent = '';
    arrivalError.textContent = '';
    idCardError.textContent = '';
    dateError.textContent = '';

    let valid = true;

    const namePattern = /^[A-Za-z\s]+$/;
    if (!namePattern.test(name)) {
      nameError.textContent = 'Name must contain only alphabets.';
      valid = false;
    }

    if (departure === arrival) {
      departureError.textContent = 'Please enter a valid departure station.';
      arrivalError.textContent = 'Please enter a valid arrival station.';
      valid = false;
    }

    if (idcard.length < 12) {
      idCardError.textContent = 'Identity card number must be at least 12 characters long.';
      valid = false;
    }

    const currentDate = new Date();
    const selectedDate = new Date(date);
    if (selectedDate < currentDate.setHours(0,0,0,0)) {
      dateError.textContent = 'Please enter a valid date.';
      valid = false;
    }

    if (!departure || !arrival || !date || !passengers || !time || !name || !idcard || !category) {
      alert('Please fill in all fields.');
      valid = false;
    }

    if (valid) {
      const formData = new FormData();
      formData.append('name', name);
      formData.append('departure', departure);
      formData.append('arrival', arrival);
      formData.append('id', idcard);
      formData.append('date', date);
      formData.append('time', time);
      formData.append('category', category);
      formData.append('passengers', passengers);

      fetch('interdata.php', {
        method: 'POST',
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        if (data.status === 'success') {
          alert('Data saved successfully to the database');
          
          localStorage.setItem('name', name);
          localStorage.setItem('idcard', idcard);
          localStorage.setItem('departure', departure);
          localStorage.setItem('arrival', arrival);
          localStorage.setItem('date', date);
          localStorage.setItem('time', time);
          localStorage.setItem('category', category);
          localStorage.setItem('passengers', passengers);

          window.location.href = 'Booked_Ticket_Inter.html';
        } else {
          alert('Error saving data to the database: ' + data.message);
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('Error processing request.');
      });
    }
  });
});

    </script>
    <script src="user.js"></script>
   
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-tnuAQdXBczz8hbNfjF1GeJ9tmh1d5BXUqj3roK54Kk51l1Zo7d1O69FdoZh0yI9G" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-8rCF9LYbAwV5w2ipIeeC7XqDfJtP/40MeNnVsReUktd57p12Xwxfp7LVGmPhT9B+" crossorigin="anonymous"></script>
  
 
  </body>
</html>
